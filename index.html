<!DOCTYPE html>
<html lang="en" dir="ltr">
  <head>
      <style media="screen">
        /* Style inputs */
          input[type=text], input[type=email], textarea {
          width: 100%;
          padding: 12px 20px;
          margin: 8px 0;
          display: inline-block;
          border: 1px solid #ccc;
          border-radius: 4px;
          box-sizing: border-box;
        }

        /* Style the submit button */
        button {
          width: 100%;
          background-color: #4CAF50;
          color: white;
          padding: 14px 20px;
          margin: 8px 0;
          border: none;
          border-radius: 4px;
          cursor: pointer;
        }

        /* Add a background color to the submit button on mouse-over */
        input[type=submit]:hover {
          background-color: #45a049;
        }
      </style>
    <title>Schedule Visitor to Aqua-Aerobic Systems, Inc</title>
  </head>
  <body>
    <h1>Schedule Visitor to Aqua-Aerobic Systems, Inc</h1> 
    <form>
      <label for="fname">First Name</label>
      <input type="text" id="fname" name="fname" placeholder="Enter their first name..">
      
       <label for="lname">Last Name</label>
      <input type="text" id="lname" name="lname" placeholder="Enter their last name..">
      
           <label for="cname">Company</label>
      <input type="text" id="cname" name="cname" placeholder="Enter their company name..">

      <label for="email">Email</label>
      <input type="email" id="email" name="email" placeholder="Enter their email address..">
      <br>
        <label for="date">Date & time of Visit</label>
        <input type="datetime-local" id="date" name="date">
<br><br>
      <label for="message">Purpose of Visit?</label>
      <textarea id="message" name="message" placeholder="Enter purpose of visit.." style="height:200px"></textarea>

      <button id="submit_msg" type="button">Schedule Meeting</button><br>
       <button id="get_msg" type="button">Get Meeting</button>
    </form>
  </body>
  <script src="https://www.gstatic.com/firebasejs/6.2.4/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/6.2.4/firebase-firestore.js"></script>
  <script type="text/javascript">
    (function() {
      var firebaseConfig = {
         apiKey: "AIzaSyC_Wl1RgIWazRk3OhodD5QQTykOcIyZMNs",
    authDomain: "aquacheckin-e0b0b.firebaseapp.com",
    projectId: "aquacheckin-e0b0b",
    storageBucket: "aquacheckin-e0b0b.appspot.com",
    messagingSenderId: "606092531450",
    appId: "1:606092531450:web:0cb5aa1499296eae14db43",
    measurementId: "G-T2LP2MT4DG"
      };

      firebase.initializeApp(firebaseConfig);

      var push_to_firebase = function(data){
        alert("Schedule was created successfully!")
        var db = firebase.firestore();

        db.collection("messages").add({
            firstname: data["fname"],
          lastname: data["lname"],
          company: data["cname"],
          date: data["date"],
            email: data["email"],
            message: data["msg"],
            timestamp: Date.now()
        })
        .then(function(docRef) {
            console.log("Message sent, ID: ", docRef.id);
            location.reload();
        })
        .catch(function(error) {
            console.error("Message could not be sent: ", error);
        });
      }
      
      var get_firebase = function(){
        alert("getting data!")
        var db = firebase.firestore();
        var query = db.collection("messages").where("lname", "==", "Konkol").where("fname", "==", "Chuck").where("date", "==", "2022-08-26T12:45");
     query.get().then((querySnapshot) => {
    querySnapshot.forEach((doc) => {
            // doc.data() is never undefined for query doc snapshots
            console.log(doc.id, " => ", doc.data());
            document.getElementById("fname") = doc.data().fname;
       document.getElementById("lname") = doc.data().lname;;
       document.getElementById("cname") = doc.data().cname;;
       document.getElementById("date") = doc.data().date;;
       document.getElementById("email") = doc.data().email;;
       document.getElementById("message") = doc.data().message;;
        });
    })
    .catch((error) => {
        console.log("Error getting documents: ", error);
    });
      }

      var contact_submit = function(){
        var fname = document.getElementById("fname");
        var lname = document.getElementById("lname");
        var cname = document.getElementById("cname");
          var date = document.getElementById("date");
        var email = document.getElementById("email");
        var msg = document.getElementById("message");

        var data = {
          "fname": fname.value,
               "lname": lname.value,
               "cname": cname.value,
          "email": email.value,
          "msg": msg.value,
          "date": date.value
        }
        push_to_firebase(data);

      }

      document.getElementById("submit_msg").addEventListener("click", contact_submit);
       document.getElementById("get_msg").addEventListener("click", get_firebase);
    })();
  </script>
</html>
