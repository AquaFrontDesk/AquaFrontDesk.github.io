<!DOCTYPE html>
<html lang="en" dir="ltr">
  <head>
    <meta charset="utf-8" name="viewport" 
        content= "width=device-width, initial-scale=1.0">
      <style media="screen">
        /* Style inputs */
             input[type=text], input[type=email], textarea {
          width: 100%;
          padding: 12px 20px;
          margin: 8px 0;
          display: inline-block;
          border: 1px solid #ccc;
          border-radius: 4px;
          box-sizing: border-box;
          background-color: aliceblue;
        }
        
         

        /* Style the submit button */
     /* Style the submit button */
        button {
          width: 100%;
          background-color: #4CAF50;
          color: white;
          padding: 14px 20px;
          margin: 8px 0;
          border: none;
          border-radius: 4px;
          cursor: pointer;
          font-size: large;
        }
        
         button2 {
          width: 50%;
          background-color: #4CAF50;
          color: white;
          padding: 14px 20px;
          margin: 8px 0;
          border: none;
          border-radius: 4px;
          cursor: pointer;
          font-size: large;
        }

        
        /* Add a background color to the submit button on mouse-over */
        input[type=submit]:hover {
          background-color: #45a049;
        }
        table {
  font-family: arial, sans-serif;
  border-collapse: collapse;
  width: 100%;
}

td, th {
  border: 1px solid #dddddd;
  text-align: left;
  padding: 8px;
}

tr:nth-child(even) {
  background-color: #dddddd;
}
      </style>
    <title>Visitor Schedule:  Aqua-Aerobic Systems</title>
  </head>
  <body style="font-family: sans-serif;font-size: large;">
    <img src="aqua.png" width="250px"></center><br>
 <h1 style="text-align: center;">Visitor Schedule for Aqua-Aerobic Systems</h1>
      <button id="schedule" type="button" style="background-color: orangered;">Schedule Visitor</button>
       <button id="getall" type="button" style="background-color: navy;">View Scheduled Visits</button>
       <div id="container">
    <form id="forms">
      <input type="hidden" id="bitly" name="bitly">  
      <input type="hidden" id="id" name="id">  
      <div id="logins">
       <label for="login" style="color: black;font-weight: bold;">Aqua Employee Network ID</label>
     <input type="text" id="login" name="login" placeholder="Please enter your Network Login ID. Example: ckonkol" style="background-color: lightyellow;">
      </div>
    <div id="meetingfields">
      <label for="fname" style="color: black;font-weight: bold;">Guest First Name</label>
      <input type="text" id="fname" name="fname" placeholder="Enter their first name..">
      
       <label for="lname" style="color: black;font-weight: bold;">Guest Last Name</label>
      <input type="text" id="lname" name="lname" placeholder="Enter their last name..">
      
           <label for="cname" style="color: black;font-weight: bold;">Guest Company Name</label>
      <input type="text" id="cname" name="cname" placeholder="Enter their company name..">

      <label for="email" style="color: black;font-weight: bold;">Guest Email</label>
      <input type="email" id="email" name="email" placeholder="Enter their email address..">
      <br>
        <label for="date" style="color: black;font-weight: bold;">Date & Time Guest is Visiting Aqua</label><br>
       <input type="datetime-local" id="date" name="date" style="font-family: sans-serif;">
 <br><br>
      <label for="message" style="color: black;font-weight: bold;">Purpose of Visit?</label>
     <textarea id="message" name="message" placeholder="Enter purpose of visit.." style="height: 50px;font-family: sans-serif;"></textarea>
       <canvas id="qrcode"></canvas> 
      <br>
    <label id="emaillink" for="emaillink" style="color: black;font-weight: bold;"></label><br>
      <hr>
    <label id="remove" for="remove" style="color: black;font-weight: bold;"></label><br>&nbsp;&nbsp;&nbsp;
    <label id="removeYes" for="removeYes" style="color: black;font-weight: bold;font-size: 12px;"></label>
     <label id="removeNo" for="removeNo" style="color: black;font-weight: bold;font-size: 12px;"></label>
        </div>
   <button id="submit_msg" type="button" style="background-color: orangered;">Schedule Visitor (All fields required!)</button>
         <button id="update_db" type="button">Update Visit</button>
        <button id="get_id" type="button" style="background-color: navy;">View Scheduled Visits (Aqua Employee Network ID required!)**</button>
       <button id="get_msg" type="button" style="background-color: cornflowerblue;">Reset Form</button>
      <br>
      <center>
       <button id="get_id2" type="button" style="display: block;width: fit-content;background-color: gray;">**View Inactive Scheduled Visits</button>
      </center>
    </form>
      
            </div>
       
    <div id="table"></div>
  </body>
 <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.0/jquery.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/qrious/4.0.2/qrious.min.js"></script>
  <script src="https://www.gstatic.com/firebasejs/6.2.4/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/6.2.4/firebase-firestore.js"></script>
  <script type="text/javascript">
    (function() {
      var firebaseConfig = {
         apiKey: "AIzaSyC_Wl1RgIWazRk3OhodD5QQTykOcIyZMNs",
    authDomain: "aquacheckin-e0b0b.firebaseapp.com",
    projectId: "aquacheckin-e0b0b",
    storageBucket: "aquacheckin-e0b0b.appspot.com",
    messagingSenderId: "606092531450",
    appId: "1:606092531450:web:0cb5aa1499296eae14db43",
    measurementId: "G-T2LP2MT4DG"
      };

      firebase.initializeApp(firebaseConfig);
      
      document.getElementById("update_db").disabled = true;
      document.getElementById('update_db').style.visibility = 'hidden';
      
      var key_checkin = "";
      var key_checkout = "";
      var gbit = "";
	    var myResponse;
  
     function createbitly(web){
  var url = web["web"]; 
    var accessToken = "fca44606568a64c736093bf2404ad2e4048b1d51";

    var params = {
        "long_url" : url           
    };

   $.ajax({
        url: "https://api-ssl.bitly.com/v4/shorten",
        cache: false,
        dataType: "json",
        method: "POST",
        contentType: "application/json",
        beforeSend: function (xhr) {
            xhr.setRequestHeader("Authorization", "Bearer " + accessToken);
        },
        data: JSON.stringify(params)
    }).done(function(data) {
	  document.getElementById("bitly").value =  data.link;
    }).fail(function(ex) {
          document.getElementById("bitly").value =  url;
      //  alert(ex.responseText);
      //alert("ShoppingList URL Copied");
    });
}
      
      var push_to_firebase = function(data){
        var db = firebase.firestore();
        var key = data["fname"] + data["lname"] + data["date"];
        var SaveDoc = db.collection("messages").doc(key);
        SaveDoc.set({
              login: data["login"],
            firstname: data["fname"],
          lastname: data["lname"],
          company: data["cname"],
          date: data["date"],
            email: data["email"],
            message: data["msg"],
            timestamp: Date.now(),
            key: data["key"],
          checkin: '',
          checkout: '',
          remove:'No'
        })
        .then(function(doc) {  
            //alert("Schedule was created successfully!")
            console.log("doc added");
           window.location.href = 'https://aquafrontdesk.github.io/?id=' + key;
  }).catch(function(error) {
    console.log("Error getting document:", error);
  });
      }
      
      var update = function(data){
        var db = firebase.firestore();
          var key = data["id"];
        db.collection("messages").doc(key).update({
          firstname: data["fname"],
          lastname: data["lname"],
          company: data["cname"],
          date: data["date"],
            email: data["email"],
            message: data["msg"],
            timestamp: Date.now()
}) .then(function(doc) {
    console.log("doc updated");
            location.reload();
  }).catch(function(error) {
    console.log("Error getting document:", error);
  });
      }
      
        var updateremoveYes = function(data){
        var db = firebase.firestore();
          var key = data["id"];
        db.collection("messages").doc(key).update({
           remove: 'Yes'
}) .then(function(doc) {
    console.log("doc updated");
            window.location = "https://aquafrontdesk.github.io/?id=" + key;
  }).catch(function(error) {
    console.log("Error getting document:", error);
  });
      }
        
        var updateremoveNO = function(data){
        var db = firebase.firestore();
          var key = data["id"];
        db.collection("messages").doc(key).update({
           remove: 'No'
}) .then(function(doc) {
    console.log("doc updated");
             window.location = "https://aquafrontdesk.github.io/?id=" + key;
  }).catch(function(error) {
    console.log("Error getting document:", error);
  });
      }
      
      var get_firebase = function(){
        var db = firebase.firestore();
         var get_fname = document.getElementById("fname").value ;
        var get_lname = document.getElementById("lname").value ;
          var get_date = document.getElementById("date").value ;
       get_fname  = get_fname.toString();
         get_lname  = get_lname.toString();
         get_date  = get_date.toString();
        if (get_fname != null &&  get_fname != '' && get_lname != null &&  get_lname != '' && get_date  != null &&  get_date  != '') {
          console.log(get_fname);
         console.log(get_lname);
         console.log(get_date);
    db.collection("messages").where("lastname", "==",get_lname).where("firstname", "==",get_fname).where("date", "==", get_date )
    .get()
    .then((querySnapshot) => {
        querySnapshot.forEach((doc) => {
            // doc.data() is never undefined for query doc snapshots
            console.log(doc.id, " => ", doc.data());
           document.getElementById("login").value = doc.data().login;
           document.getElementById("login").readOnly = true;
            document.getElementById("fname").value = doc.data().firstname;
            document.getElementById("lname").value = doc.data().lastname;
            document.getElementById("cname").value = doc.data().company;
            document.getElementById("date").value = doc.data().date;
            document.getElementById("email").value = doc.data().email;
            document.getElementById("message").value = doc.data().message;
        });
        document.getElementById('update_db').style.visibility = 'visible';
       document.getElementById('submit_msg').style.visibility = 'hidden';
       document.getElementById("update_db").disabled = false;
        document.getElementById("submit_msg").disabled = true;
    })
    .catch((error) => {
       document.getElementById("update_db").disabled = true;
        console.log("Error getting documents: ", error);
    });
} else {
    alert("All fields required!")
}

      }
      
       var get_data = function(data){
        var db = firebase.firestore();
         var get_id = data["id"];
         console.log(get_id);
         db.collection("messages").where("key", "==",get_id)
    .get()
    .then((querySnapshot) => {
        querySnapshot.forEach((doc) => {
            // doc.data() is never undefined for query doc snapshots
            console.log(doc.id, " => ", doc.data());
            document.getElementById("id").value = doc.data().key;
           document.getElementById("login").value = doc.data().login;
           document.getElementById("login").readOnly = true;
            document.getElementById("fname").value = doc.data().firstname;
            document.getElementById("lname").value = doc.data().lastname;
            document.getElementById("cname").value = doc.data().company;
            document.getElementById("date").value = doc.data().date;
            document.getElementById("email").value = doc.data().email;
            document.getElementById("message").value = doc.data().message;
            var removewebsiteYes = "https://AquaFrontDesk.github.io/?id=" + doc.data().key + "&Remove=Yes";
           var removewebsiteNo = "https://AquaFrontDesk.github.io/?id=" + doc.data().key + "&Remove=No";

          console.log("Remove:" + doc.data().remove);
          if (doc.data().remove === 'Yes'){
            document.getElementById('qrcode').style.display = 'none';
            document.getElementById('emaillink').style.display = 'none';
             document.getElementById('removeYes').style.display = 'none';
             document.getElementById("remove").innerHTML  = "Status: InActive";
             document.getElementById("removeNo").innerHTML = "<a href='" + removewebsiteNo + "'>Click here to update status to: Active</a>";
             document.getElementById("removeYes").innerHTML = "";
          }
           if (doc.data().remove === 'No'){
             document.getElementById('removeNo').style.display = 'none';
             document.getElementById("remove").innerHTML  = "Status: Active";
             document.getElementById("removeNo").innerHTML = "";
              document.getElementById("removeYes").innerHTML = "<a href='" + removewebsiteYes + "'>Click here to update status to: InActive</a><br>";
          }
         
           var website = doc.data().key + '&checkin=Now';
        
	// var emailwebsite2 = document.getElementById("bitly").value; //document.getElementById("bitly").value;
         // console.log("bitly: " + document.getElementById("bitly").value);
          //createbitly
         // var emailwebsite1 = "<a href=" + document.getElementById("bitly").value + ">Click Here for QR Code</a>";
         document.getElementById("emaillink").innerHTML = "<a href='mailto:" + doc.data().email + "?subject=Upcoming Meeting at Aqua-Aerobic Systems on " + doc.data().date.replace("T", " ") + "&body=" + doc.data().firstname + " " + doc.data().lastname + ",%0D%0A%0D%0AMeeting Date/Time: " + doc.data().date.replace("T", " ") + "%0D%0A%0D%0APurpose of Meeting : " + doc.data().message + "%0D%0A%0D%0AA unique QR code will be required to access the building beyond our lobby.%0D%0APlease use below link to get QR code.%0D%0A" + document.getElementById("bitly").value + "'>Click here to create email to guest...</a>";
          var qrcode = new QRious({
  element: document.getElementById("qrcode"),
  background: '#ffffff',
  backgroundAlpha: 1,
  foreground: '#5868bf',
  foregroundAlpha: 1,
  level: 'H',
  padding: 0,
  size: 128,
  value: website
});
        }); 
           document.getElementById('update_db').style.visibility = 'visible';
        document.getElementById('submit_msg').style.visibility = 'hidden';
         document.getElementById("update_db").disabled = false;
        document.getElementById("submit_msg").disabled = true;
    })
    .catch((error) => {
       console.log("Error getting documents: ", error);
    });
      }
       
  
       
       var get_checkin_data = function(data){
        var db = firebase.firestore();
         var get_id = data["id"];
         db.collection("messages").where("key", "==",get_id)
    .get()
    .then((querySnapshot) => {
        querySnapshot.forEach((doc) => {
           key_checkin = doc.data().checkin;
           key_checkout = doc.data().checkout;
           varFName = doc.data().firstname;
           varLName = doc.data().lastname;
           varDT = doc.data().date;
           varAqua = doc.data().login;
       
        }); 
             console.log("key_checkin:" + key_checkin);
    console.log("key_checkout:" + key_checkout);
    console.log("keyid" + get_id);
  if ((key_checkin === null || key_checkin === '') && (key_checkout === null || key_checkout === '')){
           set_checkin(data);
           document.write('<body style="font-family: sans-serif;font-size: x-large;color: blue;">');
           document.write("Thank you, " + varFName + " " + varLName + "<br>");
          document.write("You have been successfully checked in!<br>");
     document.write("<hr>");
          varDT = varDT.replace("T", " ");
           document.write("Appointment with: " + varAqua);
          document.write("<br>Appointment date/time: " +  varDT);
    document.write("<hr>");
            document.write("Someone will come get you very soon!");
    document.write("<br><br>While waiting, please put on generated badge from printer!");
     document.write("<br><br>Thanks for your patience!");
    document.write('</body>');
    console.log("checkin successful");
  }else if ((key_checkin !=null && key_checkin != '') && (key_checkout === null || key_checkout === '')){
           set_checkout(data);
            document.write('<body style="font-family: sans-serif;font-size: x-large;color: blue;">');
                document.write("Thank you, " + varFName + " " + varLName + "<br>");
          document.write("You have been successfully checked out!<br>");
           document.write("<br>Please dispose of your badge before leaving foyer!");
            document.write("<br>Have a great day!");
    document.write('</body>');
    console.log("checkout successful");
  }else if ((key_checkin !=null && key_checkin != '') && (key_checkout !=null && key_checkout != '') ){
           //qr code used already
        console.log("already used");
        document.write('<body style="font-family: sans-serif;font-size: x-large;color: blue;">');
         document.write('This QR code has expired!');
         document.write('</body>');
  }else{
    
  }
    })
    .catch((error) => {
       console.log("Error getting documents: ", error);
    });
      }
       
       function toTimestamp(strDate){
   var datum = Date.parse(strDate);
   return datum/1000;
}
       
             var set_checkin = function(data){
        var db = firebase.firestore();
          var key = data["id"];
        db.collection("messages").doc(key).update({
           checkin: Date().toLocaleString()
}) .then(function(doc) {
    console.log("doc updated");
  }).catch(function(error) {
    console.log("Error getting document:", error);
  });
      }
             
      var set_checkout = function(data){
        var db = firebase.firestore();
          var key = data["id"];
        db.collection("messages").doc(key).update({
           checkout: Date().toLocaleString()
}) .then(function(doc) {
    console.log("doc updated");
  }).catch(function(error) {
    console.log("Error getting document:", error);
  });
      }
       
       var loadweb = function(){
      window.location.href = window.location.pathname;
       }
      
       var loadfromid = function(data){
        var db = firebase.firestore();
    db.collection("messages").where("lastname", "==",data["lname"]).where("firstname", "==",data["fname"]).where("date", "==", data["date"])
    .get()
    .then((querySnapshot) => {
        querySnapshot.forEach((doc) => {
            // doc.data() is never undefined for query doc snapshots
            console.log(doc.id, " => ", doc.data());
           document.getElementById("login").value = doc.data().login;
           document.getElementById("login").readOnly = true;
            document.getElementById("fname").value = doc.data().firstname;
            document.getElementById("lname").value = doc.data().lastname;
            document.getElementById("cname").value = doc.data().company;
            document.getElementById("date").value = doc.data().date;
            document.getElementById("email").value = doc.data().email;
            document.getElementById("message").value = doc.data().message;
        });
                 document.getElementById('update_db').style.visibility = 'visible';
        document.getElementById('submit_msg').style.visibility = 'hidden';
    })
    .catch((error) => {
        console.log("Error getting documents: ", error);
    });
      }
      
       var loaddb =  function(data){
        var db = firebase.firestore();
          var get_login  = data["userid"];
         if (get_login  === null || get_login === '') {
               alert("Enter your Network Login ID above & try again!");
          }else{
       get_login  = get_login.toString();
     console.log(get_login);
      var header = "<style>table, td, th {  border: 1px solid #cbbbbb;  text-align: left;}table {  border-collapse: collapse;  width: 100%;}th, td {  padding: 15px;} tr:nth-child(even) {  background-color: #dddddd;}</style></head>";
    document.write("<center><h1>Aqua-Aerobic Systems Check-in/out Visitor Schedule</h1><h2>Active Visitor Schedule(s) for: " + get_login + "</h2><a href='https://aquafrontdesk.github.io/'>Go Home</a><br><br></center><table>  <tr>    <th>Aqua Employee</th>    <th>First Name</th>    <th>Last Name</th>    <th>Company</th>     <th>Date/Time</th>      <th>Email</th>       <th>Purpose of Visit</th><th>CheckIn</th><th>CheckOut</th><th>Edit</th>  </tr>");
    var lines = "";
            let today = new Date().toISOString().slice(0, 10);
         db.collection("messages").where("login", "==",get_login).where("remove", "==","No").orderBy("date","desc")
    .get()
    .then((querySnapshot) => {
        querySnapshot.forEach((doc) => {
            // doc.data() is never undefined for query doc snapshots
            console.log(doc.id, " => ", doc.data());
        //   document.write(doc.data().login + "," + doc.data().firstname + "," + doc.data().lastname + "," + doc.data().company + "," + doc.data().date + "," + doc.data().email + "," + doc.data().message + "," +  doc.id + "<br>");
           var data = {
          "login": doc.data().login,
          "fname": doc.data().firstname,
               "lname": doc.data().lastname,
               "cname": doc.data().company,
          "email": doc.data().email,
          "msg": doc.data().message,
          "date":doc.data().date
        }
          document.write('<tr><td>' + doc.data().login + '</td><td>' + doc.data().firstname + '</td><td>' + doc.data().lastname + '</td><td>' + doc.data().company + '</td><td>' + doc.data().date.replace("T", " ") + '</td><td>' + doc.data().email + '</td><td>' + doc.data().message + '</td><td>' + doc.data().checkin + '</td><td>' + doc.data().checkout + '</td><td><a href="https://aquafrontdesk.github.io/?id=' + doc.data().key + '">Click here</a></td></tr>');
        });
                  document.write("</table>");
       document.head.innerHTML = header;
               // document.getElementById('update_db').style.visibility = 'visible';
        //document.getElementById('submit_msg').style.visibility = 'hidden';
    })
    .catch((error) => {
        console.log("Error getting documents: ", error);
    });
           }
      }
       
       
       
         var loaddball =  function(data){
        var db = firebase.firestore();
         var get_login = data["userid"];
         if (get_login  === null || get_login === '') {
               alert("Enter your Network Login ID above & try again!");
          }else{
       get_login  = get_login.toString();
     console.log(get_login);
      var header = "<style>table, td, th {  border: 1px solid #cbbbbb;  text-align: left;}table {  border-collapse: collapse;  width: 100%;}th, td {  padding: 15px;} tr:nth-child(even) {  background-color: #dddddd;}</style></head>";
    document.write("<center><h1>Aqua-Aerobic Systems Check-in/out Visitor Schedule</h1><h2>In-Active Visitor Schedule(s) for: " + get_login + "</h2><a href='https://aquafrontdesk.github.io/'>Go Home</a></center><table>  <tr>    <th>Aqua Employee</th>    <th>First Name</th>    <th>Last Name</th>    <th>Company</th>     <th>Date/Time</th>      <th>Email</th>       <th>Purpose of Visit</th><th>CheckIn</th><th>CheckOut</th><th>Edit</th>  </tr>");
    var lines = "";
            let today = new Date().toISOString().slice(0, 10);
         db.collection("messages").where("login", "==",get_login).where("remove", "==","Yes").orderBy("date","desc")
    .get()
    .then((querySnapshot) => {
        querySnapshot.forEach((doc) => {
            // doc.data() is never undefined for query doc snapshots
            console.log(doc.id, " => ", doc.data());
        //   document.write(doc.data().login + "," + doc.data().firstname + "," + doc.data().lastname + "," + doc.data().company + "," + doc.data().date + "," + doc.data().email + "," + doc.data().message + "," +  doc.id + "<br>");
           var data = {
          "login": doc.data().login,
          "fname": doc.data().firstname,
               "lname": doc.data().lastname,
               "cname": doc.data().company,
          "email": doc.data().email,
          "msg": doc.data().message,
          "date":doc.data().date
        }
          document.write('<tr><td>' + doc.data().login + '</td><td>' + doc.data().firstname + '</td><td>' + doc.data().lastname + '</td><td>' + doc.data().company + '</td><td>' + doc.data().date.replace("T", " ") + '</td><td>' + doc.data().email + '</td><td>' + doc.data().message + '</td><td>' + doc.data().checkin + '</td><td>' + doc.data().checkout + '</td><td><a href="https://aquafrontdesk.github.io/?id=' + doc.data().key + '">Click here</a></td></tr>');
        });
                  document.write("</table>");
       document.head.innerHTML = header;
               // document.getElementById('update_db').style.visibility = 'visible';
        //document.getElementById('submit_msg').style.visibility = 'hidden';
    })
    .catch((error) => {
        console.log("Error getting documents: ", error);
    });
           }
      }
       
       var getloginname = function(){
            var username = document.getElementById("login").value;
         console.log("LoginName: " + username);
          if (username  === null || username === '') {
               alert("Enter your Network Login ID above & try again!");
          }else{
             var data = {
          "userid": username
        }
           loaddb(data);
          }
       }
       
       var getloginname2 = function(){
            var username = document.getElementById("login").value;
         console.log("LoginName: " + username);
          if (username  === null || username === '') {
               alert("Enter your Network Login ID above & try again!");
          }else{
             var data = {
          "userid": username
        }
           loaddball(data);
          }
       }


      var contact_submit = function(){
         var login = document.getElementById("login");
        var fname = document.getElementById("fname");
        var lname = document.getElementById("lname");
        var cname = document.getElementById("cname");
          var date = document.getElementById("date");
        var email = document.getElementById("email");
        var msg = document.getElementById("message");

        var data = {
          "login": login.value,
          "fname": fname.value,
               "lname": lname.value,
               "cname": cname.value,
          "email": email.value,
          "msg": msg.value,
          "date": date.value.toLocaleString('en-US', { hour: 'numeric', minute: 'numeric', hour12: true }),
          "key": fname.value + lname.value + date.value
        }
        
// empty string
if (login.value != null &&  login.value != '' && fname.value != null &&  fname.value != '' && lname.value != null &&  lname.value != '' && cname.value != null &&  cname.value != '' && email.value != null &&  email.value != ''  && msg.value != null &&  msg.value != ''   && date.value != null &&  date.value != '') {
     push_to_firebase(data);
} else {
    alert("All fields required!")
}
    

      }
      
     
      
       var update_submit = function(){
            var id = document.getElementById("id");
           var login = document.getElementById("login");
        var fname = document.getElementById("fname");
        var lname = document.getElementById("lname");
        var cname = document.getElementById("cname");
          var date = document.getElementById("date");
        var email = document.getElementById("email");
        var msg = document.getElementById("message");

        var data = {
             "id": id.value,
            "login": login.value,
          "fname": fname.value,
               "lname": lname.value,
               "cname": cname.value,
          "email": email.value,
          "msg": msg.value,
          "date": date.value.toLocaleString('en-US', { hour: 'numeric', minute: 'numeric', hour12: true })
        }
        update(data);

      }
       
       var schedule = function(){
        document.getElementById('logins').style.display = 'contents';
          document.getElementById('logins').style.display = 'block';
        document.getElementById('schedule').style.display = 'none';
        document.getElementById('getall').style.display = 'none';
        document.getElementById('meetingfields').style.display = 'block';
        document.getElementById('submit_msg').style.display = 'block';
       document.getElementById('update_db').style.display = 'none';
       document.getElementById('get_id').style.display = 'block';
      document.getElementById('get_msg').style.display = 'block';
         document.getElementById('get_id2').style.display = 'block';
       }
       
         var updateschedule = function(){
        document.getElementById('logins').style.display = 'contents';
          document.getElementById('logins').style.display = 'block';
        document.getElementById('schedule').style.display = 'none';
        document.getElementById('getall').style.display = 'none';
        document.getElementById('meetingfields').style.display = 'block';
        document.getElementById('submit_msg').style.display = 'none';
       document.getElementById('update_db').style.display = 'block';
       document.getElementById('get_id').style.display = 'block';
      document.getElementById('get_msg').style.display = 'block';
                 document.getElementById('get_id2').style.display = 'block';
       }
       
       var getall = function(){
           
         document.getElementById('logins').style.display = 'contents';
          document.getElementById('logins').style.display = 'block';
       document.getElementById('schedule').style.display = 'none';
        document.getElementById('getall').style.display = 'none';
        document.getElementById('meetingfields').style.display = 'none';
        document.getElementById('submit_msg').style.display = 'none';
       document.getElementById('update_db').style.display = 'none';
       document.getElementById('get_id').style.display = 'block';
      document.getElementById('get_msg').style.display = 'block';
          document.getElementById('get_id2').style.display = 'block';
       }
       
       
       
         document.getElementById('schedule').style.display = 'block';
        document.getElementById('getall').style.display = 'block';
        document.getElementById('meetingfields').style.display = 'none';
        document.getElementById('submit_msg').style.display = 'none';
       document.getElementById('update_db').style.display = 'none';
       document.getElementById('get_id').style.display = 'none';
      document.getElementById('get_msg').style.display = 'none';
       document.getElementById('logins').style.display = 'none';
       document.getElementById('get_id2').style.display = 'none';

      document.getElementById("submit_msg").addEventListener("click", contact_submit);
       document.getElementById("update_db").addEventListener("click",update_submit);
       document.getElementById("get_id").addEventListener("click",getloginname);
             document.getElementById("get_msg").addEventListener("click", loadweb);
            document.getElementById("get_id2").addEventListener("click", getloginname2);
            document.getElementById("schedule").addEventListener("click", schedule);
            document.getElementById("getall").addEventListener("click", getall);
   
          var queryString = window.location.search;
      console.log(queryString);
      var urlParams = new URLSearchParams(queryString);
      
        var id_remove = urlParams.get('Remove')
      console.log(id_remove);
      
        var id_active = urlParams.get('Active')
      console.log(id_active);
      
      var id = urlParams.get('id')
      console.log(id);
      
        var userid = urlParams.get('userid')
      console.log(userid);
      
      var keyid = urlParams.get('key')
      console.log(keyid);
      
            var checkin = urlParams.get('checkin')
      console.log(checkin);
      
            var checkout = urlParams.get('checkout')
      console.log(checkout);

// empty string
if ((id_active === 'No') && (userid != null && userid != '')) {
   var data = {
          "userid": userid,
        }
       loaddball(data);
} else {
  console.log('string IS empty');
}     
      
if ((id_active === 'Yes') && (userid != null && userid != '')) {
   var data = {
          "userid": userid,
        }
       loaddb(data);
} else {
  console.log('string IS empty');
}    
      
if ((id_remove === 'Yes') && (id != null && id != '')) {
  var data = {
          "id": id
        }
      updateremoveYes(data);
} else {
  console.log('string IS empty');
}      
      
 if ((id_remove === 'No') && (id != null && id != '')) {
  var data = {
          "id": id
        }
      updateremoveNO(data);
} else {
  console.log('string IS empty');
}       
      
      
if (id != null && id != '') {
  console.log('string is NOT empty');
  var website = id + '&checkin=Now';	
	var emailwebsite = "https://aquameeting.github.io/?key=" + website;
	var data2 = {
          "web": emailwebsite
        }
         createbitly(data2);
  var data = {
          "id": id
        }
        key_id="";
        updateschedule();
         get_data(data);
} else {
  console.log('string IS empty');
}
      
      // empty string
if ((checkin != null && checkin != '') &&  (keyid != null && keyid != '')) {
  console.log('string is NOT empty');
  var data = {
          "checkin": checkin,
           "id": keyid
        }
  get_checkin_data(data);
} else {
  console.log('string IS empty');
}

      
    })();
  </script>
</html>
